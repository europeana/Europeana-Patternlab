define(["jquery"],function(a){a("head").append('<link rel="stylesheet" href="'+require.toUrl("../eu/feedback/style.css")+'" type="text/css"/>');var b=function(a){console.log("eu-feedback: "+a)},c=function(c,d){var e=c.find(".feedback-toggle .open"),f=c.find(".feedback-toggle .close"),g=c.find(".feedback-counter"),h=c.find(".feedback-spinner"),i=c.find(".feedback-send"),j=c.find(".feedback-text"),k=0;d=d?d:{},e.on("click",function(){c.addClass("open"),f.addClass("visible"),e.removeClass("visible")}),f.on("click",function(){c.removeClass("open"),e.addClass("visible"),f.removeClass("visible"),b("delay"),c.find(".step1").delay(200).show(0),c.find(".step2").delay(200).hide(0),c.find(".feedback-error").delay(200).hide(0)}),i.on("click",function(){if(0==j.val().length)return j.addClass("error"),void g.addClass("error");h.show();var e=c.find("form").attr("action"),f={type:c.find("input[name=type]:checked").val(),text:j.val(),page:window.location.href},i=d.beforeSend?d.beforeSend:null;b("beforeSend = "+i),a.ajax({beforeSend:d.beforeSend?d.beforeSend:null,url:e,type:"POST",data:f,success:function(a){h.hide(),c.find(".step1").hide(),c.find(".step2").show(),j.val("")},error:function(a){setTimeout(function(){c.find(".feedback-error").show(),c.find(".step1").hide(),h.hide()},2e3)}})}),c.find(".pageurl").val(window.location.href),k=parseInt(g.data("maxlength")),g.html(k-j.val().length),j.on("keyup",function(){g.html(k-j.val().length),j.removeClass("error"),g.removeClass("error")})};return{init:function(a,b){new c(a,b)}}});