define([],function(){"use strict";function a(a){console.log("video-viewer: "+a)}function b(b){if(!b)return a("no element to get item from"),null;var c={url:b.attr("data-uri"),data_type:b.attr("data-type"),mime_type:b.attr("data-mime-type")};"audio/x-flac"==c.mime_type&&(c.mime_type="audio/flac");var d=c.url&&c.mime_type&&c.data_type;return d||(a("invalid item markup: missing [url, mime_type, data_type] ["+c.url+", "+c.mime_type+", "+c.data_type+"]"),c=null),c}function c(b){a("initFlac"),i.attr("data-setup",'{ "techOrder": ["aurora"] }'),require(["aurora"],function(){require(["flac"],function(){require(["videojs_aurora"],function(){b()})})})}function d(b){a("initSilverlight"),require(["videojs_silverlight"],function(){b({silverlight:{xap:k},techOrder:["silverlight"]})})}function e(b,e){switch(a("determineMediaViewer: "+b),b){case"audio/flac":c(e);break;case"video/wmv":d(e);break;case"video/x-msvideo":d(e);break;case"video/x-ms-wmv":d(e);break;default:e()}}function f(a){h.src([{type:a.mime_type,src:a.url}]),h.play()}function g(b){return a("init video viewer with media_item:\n	"+JSON.stringify(b,null,4)),i=$(b.data_type),"audio/x-flac"==b.mime_type&&(b.mime_type="audio/flac"),b.mime_type?0==i.length&&(a("viewer length is zero"),$(".object-media-"+b.data_type).append(l[b.data_type]),i=$(".object-media-"+b.data_type+" "+b.data_type),0==i.length)?void a("missing player markup"):void require(["videojs"],function(){e(b.mime_type,function(c){if(h=videojs(i[0],{}),c)for(var d in c)videojs.options[d]=c[d],a("set player option:	"+d+" = "+c[d]);f(b),$(".media-viewer").trigger("object-media-open",{hide_thumb:!0})})}):void a("no mime type available")}var h=null,i=null,j=require.toUrl("../lib/videojs/videojs.css"),k=require.toUrl("../lib/videojs-silverlight/video-js.xap"),l={audio:$(".object-media-audio").length>0?$(".object-media-audio audio")[0].outerHTML:"",video:$(".object-media-video").length>0?$(".object-media-video video")[0].outerHTML:""};return $("head").append('<link rel="stylesheet" href="'+j+'" type="text/css"/>'),{init:function(a){g(a)},hide:function(a){console.log("video - hiding.... "+h),h&&(h.dispose(),$(h.el).remove(),h=null)},getItemFromMarkup:function(a){return b(a)}}});